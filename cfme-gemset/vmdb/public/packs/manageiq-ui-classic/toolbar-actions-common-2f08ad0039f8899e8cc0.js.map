{"version":3,"sources":["webpack:///(webpack)/buildin/global.js","webpack:///(webpack)/buildin/module.js","webpack:///./app/javascript/toolbar-actions/custom-action.js","webpack:///./app/javascript/toolbar-actions/delete.js","webpack:///./app/javascript/packs/toolbar-actions-common.js"],"names":["g","this","Function","eval","e","window","_typeof","module","exports","webpackPolyfill","deprecate","paths","children","Object","defineProperty","enumerable","get","l","i","customActionFunction","APIFunction","onCustomAction","payload","resources","customAction","action","entity","_http_api","__webpack_require__","Error","actionType","API","post","then","data","results","length","add_flash","sprintf","__","catch","showMessage","generateMessages","APIDelete","customActionDelete","onDelete","labels","messages","arguments","undefined","single","multiple","keys","forEach","msgStatus","statusKey","label","reduce","result","statusMessages","_extends","prototype","hasOwnProperty","call","success","false","true","_data","_resources","getGridChecks","_delete2","_customAction","transformResource","resource","id","ManageIQ","gridChecks","record","recordId","map","eventMapper","controllerName","listenToRx","event","type","controller","callMapperFunction","subscribeToRx","delete","generic"],"mappings":"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","file":"manageiq-ui-classic/toolbar-actions-common-2f08ad0039f8899e8cc0.js","sourcesContent":["var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","import { API } from '../http_api';\n\nexport function customActionFunction(payload, resources) {\n  throw new Error(`customAction ${payload.action} not yet implemented!`, payload, resources);\n}\n\nexport function APIFunction(actionType, entity, resources) {\n  return API.post(`/api/${entity}`, {\n    action: actionType,\n    resources,\n  })\n    .then((data) => {\n      if (data.results && data.results.length > 1) {\n        add_flash(sprintf(__('Requested %s of selected items.'), actionType), 'success');\n      } else {\n        add_flash(sprintf(__('Requested %s of selected item.'), actionType), 'success');\n      }\n      return data;\n    })\n    .catch(data => data);\n}\n\nexport function onCustomAction(payload, resources) {\n  if (payload.customAction) {\n    return customActionFunction(payload, resources);\n  }\n  return APIFunction(payload.action, payload.entity, resources);\n}\n","import { API } from '../http_api';\n\nexport function showMessage(messages, labels = { single: '', multiple: '' }) {\n  Object.keys(messages).forEach((msgStatus) => {\n    const statusKey = msgStatus === 'true';\n    const label = messages[statusKey] === 1 ? labels.single : labels.multiple;\n\n    if (statusKey && messages[statusKey] > 0) {\n      add_flash(sprintf(__('Delete initiated for %s %s.'), messages[statusKey], label), 'success');\n    } else if (messages[statusKey] > 0) {\n      add_flash(sprintf(__('Failed to delete %s %s.'), messages[statusKey], label), 'error');\n    }\n  });\n}\n\nexport function generateMessages(results) {\n  return results.reduce((messages, result) => {\n    const statusMessages = Object.assign(messages);\n    if (Object.prototype.hasOwnProperty.call(result, 'success')) {\n      statusMessages[result.success] += 1;\n    }\n    return statusMessages;\n  }, { false: 0, true: 0 });\n}\n\nexport function APIDelete(entity, resources, labels) {\n  API.post(`/api/${entity}`, {\n    action: 'delete',\n    resources,\n  })\n  .then((data) => {\n    showMessage(generateMessages(data.results), labels);\n    return data;\n  });\n}\n\nexport function customActionDelete(_data, _resources) {\n  throw new Error('customURLDelete not implemented yet');\n}\n\nexport function onDelete(data, resources) {\n  if (data.customAction) {\n    customActionDelete(data, resources);\n  } else {\n    APIDelete(data.entity, resources, data.labels);\n  }\n}\n","import { onDelete } from '../toolbar-actions/delete';\nimport { onCustomAction } from '../toolbar-actions/custom-action';\n\nfunction transformResource(resource) {\n  return ({ id: resource });\n}\n\nexport default function getGridChecks() {\n  if (ManageIQ.gridChecks.length === 0) {\n    return [ManageIQ.record.recordId].map(transformResource);\n  }\n  return ManageIQ.gridChecks.map(transformResource);\n}\n\nfunction callMapperFunction(eventMapper, event) {\n  return Object.prototype.hasOwnProperty.call(eventMapper, event.type)\n    && eventMapper[event.type](event.payload);\n}\n\nfunction subscribeToRx(eventMapper, controllerName) {\n  listenToRx(function(event) {\n    if (!event.type) {\n      return;\n    }\n\n    if (event.controller !== controllerName) {\n      return;\n    }\n\n    return callMapperFunction(eventMapper, event);\n  });\n}\n\n/**\n * Function event mapper for observed RX subject.\n * For action:\n *     {type: 'example', payload: {...}}\n * You need to add:\n *     example: (data) => exampleFunction(data)\n * Where exampleFunction is you function which is triggered whenever new action is dispatched\n * to RX with type 'example'.\n */\nconst eventMapper = {\n  'delete': data => onDelete(data, getGridChecks()),\n  'generic': data => onCustomAction(data, getGridChecks()),\n};\n\nsubscribeToRx(eventMapper, 'toolbarActions');\n"],"sourceRoot":""}